# {{ ansible_managed }}
# CoreDNS DNS server

[Unit]
Description=CoreDNS DNS server
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User={{ coredns_user }}
Group={{ coredns_group }}
ExecStart=/usr/local/bin/coredns -conf {{ coredns_config_dir }}/Corefile
Restart=on-failure
RestartSec=10
StandardOutput=journal
StandardError=journal

# Security hardening
NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=yes
ReadOnlyPaths={{ coredns_config_dir }}
PrivateTmp=yes
# Allow binding to privileged port 53
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
